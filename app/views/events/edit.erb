<% if @event.errors.any? %>
<ul class="errors">
  <% @event.errors.full_messages.each do |msg|  %>
  <li>
    <%= msg %>
  </li>
  <% end  %>
</ul>
<% end  %>
<%= form_for @event do |f| %>
<h2>Edit Event</h2>
  <%= f.label :name, "Event Name:" %>
  <%= f.text_field :name, {size:"48"} %><br><br>
  <%= f.label :date, "Choose a Saturday:" %>
  <%= f.select :date, @dates_plus %>

<br><br>

  <%= f.label :description, "Event Description:" %><br>
  <%= f.text_area :description,{rows: "9",cols: "60"} %><br><br>

  <label>Event Guests:</label>

  <input list="guest_autocomplete" size="30">
    <datalist id="guest_autocomplete">

      <% User.all.each do |guest| %>
        <option value="<%= guest.fullname %>">
      <% end %>
    </datalist>
    <button type="button">Add Guest to Guest List</button>
    <br>
    <div id="checked">
      <%= f.collection_check_boxes :guest_ids, @event.guests, :id, :fullname, {} do |b|
        b.label(style: "margin-right:50px;white-space:nowrap; display:inline-block;") { b.label + ": "+ b.check_box(checked:"checked")}
      end %>
    </div>
    <br><br>
  <%= f.label :location_id, "Location:" %><br>
  <%= f.collection_select :location_id, Location.all, :id, :name %><br><br>
  <%= f.label :amenities, "Choose Amenities:" %><br>

  <%= f.collection_check_boxes :amenity_ids, Amenity.all, :id, :name, {} do |b|
    b.label(style: "margin-right:50px;white-space:nowrap; display:inline-block;") { b.label + ": "+ b.check_box}
  end  %>

  <%= f.hidden_field :host_id, value: current_user.id %><br><br>

  <%= f.submit %>


  <script type="text/javascript">
  $("datalist option").eq(<%= current_user.id - 1 %>).val("");

  $("button").click(function(event){
  event.preventDefault();

  var name = $("input[list='guest_autocomplete']").val();

  var id = $("datalist option[value='" + name + "']:first").index() +1;

  $("input[list='guest_autocomplete']").val("");
  $("datalist option[value='" + name + "']:first").val("");

  $("#checked").append('<div style=\"margin-right:50px;white-space:nowrap; display:inline-block"><label for=\"event_guest_ids_' + id + '\">' + name + '</label>: <input type=\"checkbox\" value=\"' + id + '\" checked=\"checked\" name=\"event[guest_ids][]\" id=\"event_guest_ids_' + id + '\">');
  });
</script>
<% end %>
